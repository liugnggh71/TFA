<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- $Header: 00001_edb360_323688_index v192 (2019-03-23) carlos.sierra $ -->
<!-- edb360_copyright (c) 2019, All rights reserved. -->
<!-- Author: carlos.sierra.usa@gmail.com -->

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="icon" href="edb360_favicon.ico" type="image/x-icon" />
<title>Scheduler "resmgr:cpu quantum" Average Latency</title>

<style type="text/css">
body             {font:10pt Arial,Helvetica,Geneva,sans-serif; color:black; background:white;}
h1               {font-size:16pt; font-weight:bold; color:#336699; border-bottom:1px solid #336699; margin-top:0pt; margin-bottom:0pt; padding:0px 0px 0px 0px;}
h2               {font-size:14pt; font-weight:bold; color:#336699; margin-top:4pt; margin-bottom:0pt;}
h3               {font-size:12pt; font-weight:bold; color:#336699; margin-top:4pt; margin-bottom:0pt;}
pre              {font:8pt monospace,Monaco,"Courier New",Courier;}
a                {color:#663300;}
table            {font-size:8pt; border-collapse:collapse; empty-cells:show; white-space:nowrap; border:1px solid #336699;}
li               {font-size:8pt; color:black; padding-left:4px; padding-right:4px; padding-bottom:2px;}
th               {font-weight:bold; color:white; background:#0066CC; padding-left:4px; padding-right:4px; padding-bottom:2px;}
tr               {color:black; background:white;}
tr:hover         {color:white; background:#0066CC;}
tr.main          {color:black; background:white;}
tr.main:hover    {color:black; background:white;}
td               {vertical-align:top; border:1px solid #336699;}
td.c             {text-align:center;}
font.n           {font-size:8pt; font-style:italic; color:#336699;}
font.f           {font-size:8pt; color:#999999; border-top:1px solid #336699; margin-top:30pt;}
div.google-chart {width:809px; height:500px;}
</style>

<!-- 00734_edb360_323688_4h_542_scheduler_resmgrcpu_quantum_average_latency_line_chart.html $ -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load("visualization", "1", {packages:["corechart"]})
google.setOnLoadCallback(drawChart)
function drawChart() {
var data = google.visualization.arrayToDataTable([
['Date', 'Average Latency', 'Latency Trend']
, [new Date(2020,9,06,18,30,16), 7.16, 7.16]
, [new Date(2020,9,06,19,00,18), 11.281, 9.786]
, [new Date(2020,9,06,19,30,21), 31.708, 16.339]
, [new Date(2020,9,06,20,00,24), 29.267, 19.571]
, [new Date(2020,9,06,20,30,01), 9.992, 20.278]
, [new Date(2020,9,06,21,00,04), 4.602, 17.19]
, [new Date(2020,9,07,18,30,13), .75, 12.233]
, [new Date(2020,9,07,19,00,16), 4.789, 11.303]
, [new Date(2020,9,07,19,30,02), 10.325, 13.789]
, [new Date(2020,9,07,20,00,05), 3.229, 10.173]
, [new Date(2020,9,07,20,30,08), 3.314, 9.549]
, [new Date(2020,9,07,21,00,12), 2.852, 8.991]
, [new Date(2020,9,08,18,30,11), 1.211, 8.392]
, [new Date(2020,9,08,19,00,02), 3.26, 8.026]
, [new Date(2020,9,08,19,30,06), 26.941, 11.966]
, [new Date(2020,9,08,20,00,10), 2.49, 8.673]
, [new Date(2020,9,08,20,30,14), 6.402, 11.105]
, [new Date(2020,9,08,21,00,17), 2.794, 8.135]
, [new Date(2020,9,09,19,00,11), 29.126, 9.24]
, [new Date(2020,9,09,19,30,14), 15.584, 9.557]
, [new Date(2020,9,09,20,00,17), 19.31, 10.022]
, [new Date(2020,9,09,20,30,20), 14.799, 10.239]
, [new Date(2020,9,09,21,00,22), 6.708, 10.085]
, [new Date(2020,9,10,19,00,13), 5, 9.873]
, [new Date(2020,9,10,19,30,16), 7.743, 12.115]
, [new Date(2020,9,10,20,00,18), 10.021, 12.378]
, [new Date(2020,9,10,20,30,21), 4.179, 9.337]
, [new Date(2020,9,10,21,00,24), 5.456, 9.198]
, [new Date(2020,9,10,21,30,26), 3.246, 8.993]
, [new Date(2020,9,11,03,30,31), 24.653, 5.266]
, [new Date(2020,9,11,04,00,33), 1, 8.727]
, [new Date(2020,9,11,19,00,14), 5.515, 13.458]
, [new Date(2020,9,11,19,30,04), 8.619, 8.579]
, [new Date(2020,9,11,20,00,09), 4.305, 8.449]
, [new Date(2020,9,11,20,30,14), 6.494, 12.949]
, [new Date(2020,9,11,21,00,17), 5.467, 8.252]
, [new Date(2020,9,11,21,30,21), 7.188, 12.65]
, [new Date(2020,9,11,22,00,23), 5.483, 8.053]
, [new Date(2020,9,12,19,00,19), 21.747, 12.717]
, [new Date(2020,9,12,19,30,22), 25.259, 13.387]
, [new Date(2020,9,12,20,00,25), 10.535, 8.526]
, [new Date(2020,9,12,20,30,27), 6.265, 13.16]
, [new Date(2020,9,12,21,00,30), 3.764, 8.3]
, [new Date(2020,9,13,18,30,22), .5, 8.119]
, [new Date(2020,9,13,19,00,03), 65.357, 9.419]
, [new Date(2020,9,13,19,30,13), 38.625, 10.068]
, [new Date(2020,9,13,20,00,20), 29.78, 10.497]
, [new Date(2020,9,13,20,30,25), 31.387, 10.941]
, [new Date(2020,9,13,21,00,29), 7.732, 15.389]
, [new Date(2020,9,14,18,30,25), 7.527, 10.776]
, [new Date(2020,9,14,19,00,29), 52.156, 16.056]
, [new Date(2020,9,14,19,30,32), 24.506, 16.526]
, [new Date(2020,9,14,20,00,35), 5.863, 16.199]
, [new Date(2020,9,14,20,30,38), 2.569, 11.212]
, [new Date(2020,9,14,21,00,40), 2.447, 11.05]
, [new Date(2020,9,15,19,00,08), 19.161, 15.801]
, [new Date(2020,9,15,19,30,13), 28.938, 16.007]
, [new Date(2020,9,15,20,00,19), 23.353, 11.644]
, [new Date(2020,9,15,20,30,23), 6.824, 15.94]
, [new Date(2020,9,15,21,00,27), 5.479, 11.449]
, [new Date(2020,9,16,18,00,22), 384, 20.892]
, [new Date(2020,9,16,18,30,25), 4491.313, 218.382]
, [new Date(2020,9,16,19,00,28), 2.911, 209.975]
, [new Date(2020,9,16,19,30,33), 10.355, 11.123]
, [new Date(2020,9,16,20,00,37), 2.717, 10.99]
, [new Date(2020,9,16,20,30,40), 2.442, 10.856]
, [new Date(2020,9,16,21,00,45), 7.21, 10.8]
, [new Date(2020,9,17,05,30,35), .875, 10.65]
, [new Date(2020,9,17,19,00,00), 2.268, 10.525]
, [new Date(2020,9,17,19,30,04), 4.086, 10.43]
, [new Date(2020,9,17,20,00,00), 4.025, 10.337]
, [new Date(2020,9,17,20,30,02), 4.749, 201.464]
, [new Date(2020,9,17,21,00,04), 2.515, 10.139]
, [new Date(2020,9,18,19,00,18), 8.065, 194.348]
, [new Date(2020,9,18,19,30,20), 11.34, 187.961]
, [new Date(2020,9,18,20,00,22), 5.024, 181.793]
, [new Date(2020,9,18,20,30,25), 2.852, 175.979]
, [new Date(2020,9,18,21,00,27), 2.392, 9.668]
, [new Date(2020,9,19,19,00,13), 3.99, 9.594]
, [new Date(2020,9,19,19,30,16), 21.052, 170.603]
, [new Date(2020,9,19,20,00,19), 7.344, 165.578]
, [new Date(2020,9,19,20,30,22), 4.171, 9.613]
, [new Date(2020,9,19,21,00,25), 3.834, 160.727]
, [new Date(2020,9,20,19,00,09), 3.2, 9.455]
, [new Date(2020,9,20,19,30,12), 5.379, 9.406]
, [new Date(2020,9,20,20,00,15), 15.419, 9.478]
, [new Date(2020,9,20,20,30,18), 4.354, 9.418]
, [new Date(2020,9,20,21,00,21), 6.874, 156.193]
, [new Date(2020,9,21,18,30,14), 2.711, 9.274]
, [new Date(2020,9,21,19,00,01), 5.867, 151.917]
, [new Date(2020,9,21,19,30,04), 5.679, 147.921]
, [new Date(2020,9,21,20,00,06), 25.83, 144.431]
, [new Date(2020,9,21,20,30,09), 13.017, 141.047]
, [new Date(2020,9,21,21,00,11), 3.92, 9.189]
, [new Date(2020,9,22,19,00,09), 13.317, 9.234]
, [new Date(2020,9,22,19,30,14), 6.713, 9.207]
, [new Date(2020,9,22,20,00,18), 25.833, 137.865]
, [new Date(2020,9,22,20,30,21), 2.214, 134.585]
, [new Date(2020,9,22,21,00,00), 10.111, 131.608]
, [new Date(2020,9,23,18,30,45), 1.464, 9.136]
, [new Date(2020,9,23,19,00,01), 3.946, 9.084]
, [new Date(2020,9,23,19,30,05), 14.082, 128.634]
, [new Date(2020,9,23,20,00,08), 13.354, 9.161]
, [new Date(2020,9,23,20,30,00), 2.773, 9.098]
, [new Date(2020,9,23,21,00,03), 2.686, 9.036]
, [new Date(2020,9,24,15,00,27), 4.234, 116.834]
, [new Date(2020,9,24,15,30,31), 2.732, 114.241]
, [new Date(2020,9,24,18,30,50), 6.339, 9.01]
, [new Date(2020,9,24,19,00,54), 7.311, 8.994]
, [new Date(2020,9,24,19,30,57), 8.817, 8.992]
, [new Date(2020,9,24,20,00,02), 7.44, 8.978]
, [new Date(2020,9,24,20,30,01), 5.887, 8.949]
, [new Date(2020,9,24,21,00,04), 8.106, 8.941]
, [new Date(2020,9,24,21,30,06), 7.308, 8.926]
, [new Date(2020,9,25,05,30,41), 8.95, 8.927]
, [new Date(2020,9,25,06,00,44), .5, 8.851]
, [new Date(2020,9,25,18,30,39), 5.971, 111.835]
, [new Date(2020,9,25,19,00,42), 6.751, 109.55]
, [new Date(2020,9,25,19,30,46), 8.05, 107.391]
, [new Date(2020,9,25,20,00,51), 8.211, 105.324]
, [new Date(2020,9,25,20,30,54), 5.865, 103.295]
, [new Date(2020,9,25,21,00,59), 9.116, 101.411]
, [new Date(2020,9,25,21,30,01), 13.418, 99.686]
, [new Date(2020,9,25,22,00,03), 6.797, 97.899]
, [new Date(2020,9,26,18,30,33), 4.769, 8.815]
, [new Date(2020,9,26,19,00,36), 6.963, 8.799]
, [new Date(2020,9,26,19,30,41), 16.253, 8.864]
, [new Date(2020,9,26,20,00,45), 10.201, 8.875]
, [new Date(2020,9,26,20,30,49), 7.914, 8.867]
, [new Date(2020,9,26,21,00,53), 10.025, 8.877]
, [new Date(2020,9,27,18,30,35), 5.379, 96.154]
, [new Date(2020,9,27,19,00,37), 16.365, 94.676]
, [new Date(2020,9,27,19,30,39), 11.503, 93.164]
, [new Date(2020,9,27,20,00,06), 76.851, 92.873]
, [new Date(2020,9,27,20,30,11), 50.044, 92.121]
, [new Date(2020,9,27,21,00,16), 8.205, 90.674]
, [new Date(2020,9,28,18,30,07), 20.016, 89.477]
, [new Date(2020,9,28,19,00,11), 9.236, 88.139]
, [new Date(2020,9,28,19,30,15), 35.976, 87.284]
, [new Date(2020,9,28,20,00,21), 24.102, 86.265]
, [new Date(2020,9,28,20,30,24), 8.001, 85.023]
, [new Date(2020,9,28,21,00,28), 9.051, 83.836]
, [new Date(2020,9,29,18,30,20), 3.827, 8.834]
, [new Date(2020,9,29,19,00,23), 20.309, 8.93]
, [new Date(2020,9,29,19,30,25), 8.955, 8.93]
, [new Date(2020,9,29,20,00,28), 20.2, 9.023]
, [new Date(2020,9,29,20,30,31), 17.172, 9.089]
, [new Date(2020,9,29,21,00,33), 7.006, 9.072]
, [new Date(2020,9,30,18,30,19), 5.934, 9.047]
, [new Date(2020,9,30,19,00,22), 20.113, 9.135]
, [new Date(2020,9,30,19,30,24), 7.82, 9.124]
, [new Date(2020,9,30,20,00,27), 7.327, 9.11]
, [new Date(2020,9,30,20,30,30), 7.668, 9.099]
, [new Date(2020,9,30,21,00,33), 8.665, 9.096]
, [new Date(2020,9,31,06,30,23), 8.639, 91.702]
, [new Date(2020,9,31,07,30,29), 3, 8.985]
, [new Date(2020,9,31,18,30,23), 3.764, 81.476]
, [new Date(2020,9,31,19,00,26), 8.535, 80.387]
, [new Date(2020,9,31,19,30,32), 9.665, 79.347]
, [new Date(2020,9,31,20,00,37), 7.606, 78.307]
, [new Date(2020,9,31,20,30,40), 6.481, 77.281]
, [new Date(2020,9,31,21,00,45), 8.645, 76.315]
, [new Date(2020,9,31,21,30,49), 9.712, 75.389]
, [new Date(2020,10,01,06,30,43), 12.886, 83.377]
, [new Date(2020,10,01,07,00,46), 74.324, 83.082]
, [new Date(2020,10,01,17,30,35), 5.13, 72.946]
, [new Date(2020,10,01,18,00,37), 7.457, 72.084]
, [new Date(2020,10,01,18,30,40), 8.911, 71.264]
, [new Date(2020,10,01,19,00,42), 6.62, 70.435]
, [new Date(2020,10,01,19,30,45), 8.119, 69.646]
, [new Date(2020,10,01,20,00,03), 8.493, 68.882]
, [new Date(2020,10,01,20,30,06), 3.746, 68.078]
, [new Date(2020,10,02,17,30,33), .938, 67.259]
, [new Date(2020,10,02,18,00,36), 7.121, 66.534]
, [new Date(2020,10,02,18,30,04), 8.546, 65.844]
, [new Date(2020,10,02,19,00,10), 7.042, 65.152]
, [new Date(2020,10,02,19,30,13), 7.985, 64.487]
, [new Date(2020,10,02,20,00,18), 9.497, 63.855]
, [new Date(2020,10,03,17,30,12), 2, 9.166]
, [new Date(2020,10,03,18,00,15), 8.421, 9.16]
, [new Date(2020,10,03,18,30,18), 7.5, 9.148]
, [new Date(2020,10,03,19,00,21), 7.563, 9.137]
, [new Date(2020,10,03,19,30,23), 22.232, 9.231]
, [new Date(2020,10,03,20,00,26), 7.542, 9.219]
, [new Date(2020,10,04,17,30,21), 4.23, 63.178]
, [new Date(2020,10,04,18,00,24), 7.172, 62.549]
, [new Date(2020,10,04,18,30,29), 8.14, 61.944]
, [new Date(2020,10,04,19,00,34), 7.863, 61.35]
, [new Date(2020,10,04,19,30,38), 12.154, 60.815]
, [new Date(2020,10,04,20,00,42), 9.417, 60.262]
, [new Date(2020,10,05,17,30,43), 5.008, 59.674]
, [new Date(2020,10,05,18,00,46), 7.66, 59.127]
, [new Date(2020,10,05,18,30,48), 8.483, 58.599]
, [new Date(2020,10,05,19,00,51), 10.871, 58.107]
, [new Date(2020,10,05,19,30,02), 18.072, 57.699]
, [new Date(2020,10,05,20,00,06), 8.093, 57.198]
]);

var options = {
chartArea:{left:90, top:75, width:'65%', height:'70%'},
backgroundColor: {fill: 'white', stroke: '#336699', strokeWidth: 1},
explorer: {actions: ['dragToZoom', 'rightClickToReset'], maxZoomIn: 0.01},
title: '4h.542. Scheduler "resmgr:cpu quantum" Average Latency',
titleTextStyle: {fontSize: 18, bold: false},
focusTarget: 'category',
legend: {position: 'right', textStyle: {fontSize: 14}},
tooltip: {textStyle: {fontSize: 14}},
hAxis: {title: ' 12.1.0.2.0 cores:16(avg) threads:16(avg) hosts:2(avg)', gridlines: {count: -1}, titleTextStyle: {fontSize: 16, bold: false}},
series: { 0: { }, 1: { },  2: { },  3: { },  4: { },  5: { },  6: { }, 7: {},
8: { }, 9: { }, 10: { }, 11: { }, 12: { }, 13: { }, 14: { }
},
vAxis: {title: 'Average Latency and Trend in milliseconds',  gridlines: {count: -1}, titleTextStyle: {fontSize: 16, bold: false}}
}

var chart = new google.visualization.LineChart(document.getElementById('linechart'))
chart.draw(data, options)
}
</script>
</head>
<body>

<h1> <a href="http://carlos-sierra.net/edb360-an-oracle-database-360-degree-view/" target="_blank"><img src="database.jpg" alt="eDB360" height="33" width="52" /></a> 4h.542. Scheduler "resmgr:cpu quantum" Average Latency <em>(DBA_HIST_EVENT_HISTOGRAM)</em>  </h1>

<br />
Trend is computed as average of "Average" so far. Thus "Trend" at time T[N] is average of "Average" between time T[0] and T[N] where N > 0.<br />

<br />

<div id="linechart" class="google-chart"></div>

<br />
<font class="n">Notes:<br />1) drag to zoom, and right click to reset<br />2) up to 31 days of awr history were considered</font>
<font class="n"><br />3) </font>
<pre>
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 SNAP_ID                                   NOT NULL NUMBER
 DBID                                      NOT NULL NUMBER
 INSTANCE_NUMBER                           NOT NULL NUMBER
 EVENT_ID                                  NOT NULL NUMBER
 EVENT_NAME                                NOT NULL VARCHAR2(64)
 WAIT_CLASS_ID                                      NUMBER
 WAIT_CLASS                                         VARCHAR2(64)
 WAIT_TIME_MILLI                           NOT NULL NUMBER
 WAIT_COUNT                                         NUMBER
 CON_DBID                                           NUMBER
 CON_ID                                             NUMBER

WITH
histogram AS (
SELECT /*+  MATERIALIZE NO_MERGE  */ /* 4h.537 */
       snap_id,
       dbid,
       instance_number,
       wait_time_milli,
       wait_count - LAG(wait_count) OVER (PARTITION BY dbid, instance_number, event_id, wait_class_id, wait_time_milli ORDER BY snap_id) wait_count_this_snap
  FROM dba_hist_event_histogram
 WHERE snap_id BETWEEN 3473 AND 4962
   AND dbid = 2109323688
   AND wait_class = TRIM('Scheduler') AND event_name = TRIM('resmgr:cpu quantum')
),
average AS (
SELECT /*+  MATERIALIZE NO_MERGE  */ /* 4h.537 */
       snap_id,
       dbid,
       instance_number,
       SUM((CASE wait_time_milli WHEN 1 THEN 0.50 ELSE 0.75 END) * wait_time_milli * wait_count_this_snap)/SUM(wait_count_this_snap) avg_wait_time_milli
  FROM histogram
 WHERE wait_count_this_snap &gt;= 0
 GROUP BY
       snap_id,
       dbid,
       instance_number
HAVING SUM(wait_count_this_snap) &gt; 0
),
average_average AS (
SELECT /*+  MATERIALIZE NO_MERGE  */ /* 4h.537 */
       a.snap_id,
       a.dbid,
       a.instance_number,
       MIN(a.avg_wait_time_milli) avg_wait_time_milli,
       AVG(b.avg_wait_time_milli) avg_avg_wait_time_milli
  FROM average a,
       average b
 WHERE b.snap_id         &lt;= a.snap_id
   AND b.dbid             = a.dbid
   AND b.instance_number  = a.instance_number
 GROUP BY
       a.snap_id,
       a.dbid,
       a.instance_number
),
per_inst AS (
SELECT /*+  MATERIALIZE NO_MERGE  */ /* 4h.537 */
       h.snap_id,
       s.begin_interval_time,
       s.end_interval_time,
       h.avg_wait_time_milli,
       h.avg_avg_wait_time_milli
  FROM average_average   h,
       dba_hist_snapshot s
 WHERE s.snap_id         = h.snap_id
   AND s.dbid            = h.dbid
   AND s.instance_number = h.instance_number
)
SELECT snap_id,
       TO_CHAR(MIN(begin_interval_time), 'YYYY-MM-DD HH24:MI:SS') begin_time,
       TO_CHAR(MIN(end_interval_time), 'YYYY-MM-DD HH24:MI:SS') end_time,
       ROUND(SUM(avg_wait_time_milli), 3) avg_latency_ms,
       ROUND(SUM(avg_avg_wait_time_milli), 3) latency_trend_ms,
       0 dummy_03,
       0 dummy_04,
       0 dummy_05,
       0 dummy_06,
       0 dummy_07,
       0 dummy_08,
       0 dummy_09,
       0 dummy_10,
       0 dummy_11,
       0 dummy_12,
       0 dummy_13,
       0 dummy_14,
       0 dummy_15
  FROM per_inst
 GROUP BY
       snap_id
 ORDER BY
       snap_id;

196 rows selected.
</pre>

<br />
<font class="f">edb360 (c) 2019. Version v192 (2019-03-23). Timestamp: 2020-11-06T12:09:00  </font>
</body>
</html>
